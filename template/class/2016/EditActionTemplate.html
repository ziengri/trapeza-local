<?php
global $setting;
if (!$inside_admin) actionObject($classID, $message, $f_Checked, $Checked);

$bitcat = new bc();
savethiszone($f_col, $f_block_id, $saveblk);
$bitcat->init_bc('savecss');

if ($cache) $db->query("update Message2016 set cache = '' where Message_ID = '$message'");

$db->query("DELETE FROM Showing_Blocks WHERE Block_ID = '$message'");
foreach ($map as $subID => $value) {
    if (!$value['sub']) continue;
    $extends = (!$value['expendet'] ? 0 : 1);
    $db->query("INSERT INTO Showing_Blocks (Block_ID, Subdivision_ID, extends) VALUES ('{$message}', '{$subID}', '{$extends}') ");
}


if($inside_admin) {
    ob_end_clean();
    header('Location: '.$goBackLink.'&inside_admin=1');
    exit;
} else {
    echo json_encode(ARRAY(
        "title" => "ОК",
        "succes" => "Блок $message изменен.",
        "reloadtab" => 1,
        "modal" => "close",
        "reload" => $settblk ? 1 : 0
    ));
}
?>
