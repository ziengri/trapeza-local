<?=($inside_admin ? $f_AdminCommon : addObjBut($addLink,$isTitle,null,'сравнение'))?>
<?php 
    global $setting_texts, $AUTH_USER_ID;
    if($_SESSION['comparison']){
        foreach ($_SESSION['comparison'] as $itemID => $siteID) {
            if($siteID == $catalogue) $thissiteItem = 1;
            continue;
        }
    }
    if($thissiteItem){
        $fields = array(
            "name" => "Наименование",
            "art" => "Артикул",
			"price" => "Цена",
            "ves" => "Вес",
            "capacity" => "Объем",
            "size" => "Размеры",
            "width" => "Ширина",
            "length" => "Длина",
            "height" => "Высота",
            "depth" => "Глубина",
            "sizes_item" => "Размер",
			"var1" => $setting_texts['var1']['checked'] ? $setting_texts['var1']['name'] : null,
			"var2" => $setting_texts['var2']['checked'] ? $setting_texts['var2']['name'] : null,
			"var3" => $setting_texts['var3']['checked'] ? $setting_texts['var3']['name'] : null,
			"var4" => $setting_texts['var4']['checked'] ? $setting_texts['var4']['name'] : null,
			"var5" => $setting_texts['var5']['checked'] ? $setting_texts['var5']['name'] : null,
			"var6" => $setting_texts['var6']['checked'] ? $setting_texts['var6']['name'] : null,
			"var7" => $setting_texts['var7']['checked'] ? $setting_texts['var7']['name'] : null,
			"var8" => $setting_texts['var8']['checked'] ? $setting_texts['var8']['name'] : null,
			"var9" => $setting_texts['var9']['checked'] ? $setting_texts['var9']['name'] : null,
			"var10" => $setting_texts['var10']['checked'] ? $setting_texts['var10']['name'] : null,
			"var11" => $setting_texts['var11']['checked'] ? $setting_texts['var11']['name'] : null,
			"var12" => $setting_texts['var12']['checked'] ? $setting_texts['var12']['name'] : null,
			"var13" => $setting_texts['var13']['checked'] ? $setting_texts['var13']['name'] : null,
			"var14" => $setting_texts['var14']['checked'] ? $setting_texts['var14']['name'] : null,
			"var15" => $setting_texts['var15']['checked'] ? $setting_texts['var15']['name'] : null,
        );
        # Массив с параметрами товаров
        foreach ($_SESSION['comparison'] as $id => $e){
            $itemObject = $catalogue == $e ? Class2001::getItemById($id) : "";
			if(!$itemObject) continue;

            $items['photo'][$id] = $itemObject->photoMain;
            foreach ($fields as $name => $filed) {
                if ($filed === null) continue;
                if($itemObject->$name) $items[$name][$id] = $itemObject->$name;
            }
            foreach ($itemObject->getParamsArray() as $key => $val) {
                $items[$key][$id] = $val['value'];
                $fields[$key] = $val['name'];
            }
        }

        foreach ($items as $key => $v){
            if(in_array($key, array('name', 'photo')) || empty($fields[$key])) continue;
            $filedsName .= "<li data-key='{$key}' class='name'>{$fields[$key]}</li>";
        }
        # Сборка параметров в html
        foreach ($items['photo'] as $item_id => $photo) {

            $fileds .= "<li class='comparison-product' data-id='{$item_id}'>
                            <div class='comparison-namefull'>
                                <div class='comparison-close'></div>
                                {$photo}
                                <h3>{$items['name'][$item_id]}</h3>
                            </div>
                            <ul class='comparison-list'>";
            foreach ($items as $key => $v){
                if(in_array($key, array('name', 'photo'))) continue;
                $fileds .= "<li data-key='{$key}'>".($v[$item_id] ? $v[$item_id] : "-")."</li>";
            }
            $fileds .= "</ul></li>";
        }
        $html = "<section class='comparison-full'>
                    <div class='comparison-table'>
                        <div class='comparison-left'>
                            <div class='comparison-info-first'>
                                <span class='title'>Товары</span>
                                <a href='javascript:void(0);' class='remove_comparison_list'>Удалить список</a>
                                <span class='title'>Показывать в таблице</span>
                                <div>
                                    " . bc_radio_standart('show_table[]', 'all', 'Все параметры', 1) . "
                                    " . bc_radio_standart('show_table[]', 'differ', 'Различающиеся', 0) . "
                                </div>
                            </div>
                            <ul class='comparison-param-name'>{$filedsName}</ul>
                        </div>
                        <div class='comparison-right'>
                            <ul class='comparison-param-value owl-carousel cb' data-margin='0' data-owl-loop='false' data-owl-nav='true' data-sizeitem='1279:4.780:3.650:2.550:1'>
                                {$fileds}
                            </ul>
                        </div>
                    </div>
                </section>";
    }else{
        $html = "<p class='no-obj'>Добавте товары для сравнения.<br><a href='/catalog/'>Перейти в каталог</a></p>";
    }

    echo $html;
?>
