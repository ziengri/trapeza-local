(function(p,n,l,r,t,y,G){function z(a){nc_event_dispatch("ncPartialUpdate",{newTemplateContent:a})}function A(a){var d=[],b=n.createNodeIterator(n.body,NodeFilter.SHOW_COMMENT,null,!1),c,e,f,g,k,m,h,u,l;for(a&&(a=H(a));c=b.nextNode();)if(e=c.nodeValue.match(I))try{g=c[B]||(c[B]=y(e[2]));k=g.data;m=g.src;if(a){l=J(a,m,k);if(!l)continue;if(!0!==l)for(var p in l)k[p]=l[p]}u=m+v(k||{});h=g.template;f={start:c,seq:e[1],param:g,query:u,key:w+(h?h+"#":"")+u};x(f);d.push(f)}catch(q){C&&C.log("Partial error:",
q.message,c)}return d}function H(a){t(a)||(a=[[a]]);h(a,function(d,b){t(d)||(a[b]=d=[d]);d[0]=(""+d[0]).split(/[\s,]+/)});return a}function x(a){for(var d=[],b=a.start;b=b.nextSibling;){if(8==b.nodeType&&-1!=b.nodeValue.indexOf("/nc_partial "+a.seq))return d;d.push(b)}throw Error();}function D(a,d){var b=a.start.parentNode;h(x(a),function(a){b.removeChild(a)});var c=b.insertBefore(n.createElement("DIV"),a.start.nextSibling);c.insertAdjacentHTML("afterend",d);b.removeChild(c);E(x(a));a.param.store&&
l.setItem(a.key,d)}function J(a,d,b){var c=!1,e=!Object.keys(b).length;h(a,function(a){var g=a[1],k;if((k=-1!=a[0].indexOf(d))&&!(k=g===G||null===g&&e)&&(k=g))a:{k=b||{};for(var m in g)if(k[m]!=g[m]){k=!1;break a}k=!0}if(k)return c=a[2]||!0,!1});return c}function F(a,d,b){if(a.length){var c,e={partial:[],referer:location.toString(),json:1};h(a,function(a){c=a.param.template||c;a=a.query;var b=e.partial;-1==b.indexOf(a)&&b.push(a)});c&&(e.template=c);var f=new XMLHttpRequest;f.open("POST",(p.NETCAT_PATH||
"/netcat/")+"partial.php");f.onreadystatechange=function(){if(4==f.readyState)if(200==f.status)try{var c=y(f.responseText);K(a,c);if(c.$){var e=c.$,m=n.createElement("DIV");m.style.display="none";m.innerHTML=e;n.body.appendChild(m);E(m.childNodes)}z(c);d(c)}catch(h){b(f)}else b(f)};f.setRequestHeader("Content-Type","application/x-www-form-urlencoded");f.send(v(e).slice(1))}}function K(a,d){h(a,function(a){a.query in d&&D(a,d[a.query])})}function v(a,d){var b=[],c,e;for(c in a)e=a[c],c=r(c),d&&(c=
d+"["+c+"]"),t(e)?h(e,function(a){b.push(c+"[]="+r(a))}):"object"==typeof e?b=b.concat(v(e,c)):b.push(c+"="+r(e));d||(b=b.length?"?"+b.join("&"):"");return b}function E(a){function d(a){h(a,function(a){"SCRIPT"==a.tagName?a.src?e.push(a.src):f.push(a.text):a.childNodes.length&&d(a.childNodes)})}function b(a,b){var d=n.head,e=n.createElement("SCRIPT");a?(e.onload=e.onerror=c,e.src=a):e.appendChild(n.createTextNode(b));d.appendChild(e);d.removeChild(e)}function c(){++g>=e.length&&b(!1,f.join("\n"))}
var e=[],f=[],g=-1;d(a);h(e,b);c()}function q(){}function h(a,d){for(var b=0;b<a.length&&!1!==d(a[b],b);b++);}p.nc_partial_load=function(a,d,b){F(A(a),d||q,b||q)};p.nc_partial_clear_cache=function(){for(var a in l)l.hasOwnProperty(a)&&!a.indexOf(w)&&l.removeItem(a)};n.addEventListener("DOMContentLoaded",function(){var a=[],d={},b;h(A(),function(c){var e=c.param,f,g;e.defer&&(g=!0,e.store&&null!==(f=l.getItem(c.key))&&(D(c,f),d[c.query]=f,b=!0,g=!1));(g||e.reload)&&a.push(c)});b&&z(d);F(a,q,q)});var I=
/nc_partial (\S+) ({.+})/,w="nc_partial_",B=w+"data",C=p.console})(window,document,sessionStorage,encodeURIComponent,Array.isArray,JSON.parse);
